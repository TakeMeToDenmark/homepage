!function(t){var e=function(e,o,n,i){this.target=e,this.url=o,this.html=[],this.effectQueue=[],this.options=t.extend({ssl:!1,host:"www.feedrapp.info",limit:null,key:null,layoutTemplate:"<ul>{entries}</ul>",entryTemplate:'<li><a href="{url}">[{author}@{date}] {title}</a><br/>{shortBodyPlain}</li>',tokens:{},outputMode:"json",dateFormat:"dddd MMM Do",dateLocale:"en",effect:"show",offsetStart:!1,offsetEnd:!1,error:function(){console.log("jQuery RSS: url doesn't link to RSS-Feed")},onData:function(){},success:function(){}},n||{}),this.options.ssl&&"www.feedrapp.info"===this.options.host&&(this.options.host="feedrapp.herokuapp.com"),this.callback=i||this.options.success};e.htmlTags="doctype,html,head,title,base,link,meta,style,script,noscript,body,article,nav,aside,section,header,footer,h1-h6,hgroup,address,p,hr,pre,blockquote,ol,ul,li,dl,dt,dd,figure,figcaption,div,table,caption,thead,tbody,tfoot,tr,th,td,col,colgroup,form,fieldset,legend,label,input,button,select,datalist,optgroup,option,textarea,keygen,output,progress,meter,details,summary,command,menu,del,ins,img,iframe,embed,object,param,video,audio,source,canvas,track,map,area,a,em,strong,i,b,u,s,small,abbr,q,cite,dfn,sub,sup,time,code,kbd,samp,var,mark,bdi,bdo,ruby,rt,rp,span,br,wbr".split(","),e.prototype.load=function(e){var o="http"+(this.options.ssl?"s":"")+"://"+this.options.host+"?callback=?&q="+encodeURIComponent(this.url);this.options.offsetStart&&this.options.offsetEnd&&(this.options.limit=this.options.offsetEnd),null!==this.options.limit&&(o+="&num="+this.options.limit),null!==this.options.key&&(o+="&key="+this.options.key),t.getJSON(o,e)},e.prototype.render=function(){var e=this;this.load(function(o){try{e.feed=o.responseData.feed,e.entries=o.responseData.feed.entries}catch(t){return e.entries=[],e.feed=null,e.options.error.call(e)}if(o=e.generateHTMLForEntries(),e.target.append(o.layout),0!==o.entries.length){t.isFunction(e.options.onData)&&e.options.onData.call(e);var n=t(o.layout).is("entries")?o.layout:t("entries",o.layout);e.appendEntriesAndApplyEffects(n,o.entries)}0<e.effectQueue.length?e.executeEffectQueue(e.callback):t.isFunction(e.callback)&&e.callback.call(e)})},e.prototype.appendEntriesAndApplyEffects=function(e,o){var n=this;t.each(o,function(t,o){var i=n.wrapContent(o);"show"===n.options.effect?e.before(i):(i.css({display:"none"}),e.before(i),n.applyEffect(i,n.options.effect))}),e.remove()},e.prototype.generateHTMLForEntries=function(){var e=this,o={entries:[],layout:null};return t(this.entries).each(function(){var t=e.options.offsetStart,n=e.options.offsetEnd;t&&n?index>=t&&index<=n&&e.isRelevant(this,o.entries)&&(t=e.evaluateStringForEntry(e.options.entryTemplate,this),o.entries.push(t)):e.isRelevant(this,o.entries)&&(t=e.evaluateStringForEntry(e.options.entryTemplate,this),o.entries.push(t))}),o.layout=this.options.entryTemplate?this.wrapContent(this.options.layoutTemplate.replace("{entries}","<entries></entries>")):this.wrapContent("<div><entries></entries></div>"),o},e.prototype.wrapContent=function(e){return 0!==t.trim(e).indexOf("<")?t("<div>"+e+"</div>"):t(e)},e.prototype.applyEffect=function(t,e,o){switch(e){case"slide":t.slideDown("slow",o);break;case"slideFast":t.slideDown(o);break;case"slideSynced":this.effectQueue.push({element:t,effect:"slide"});break;case"slideFastSynced":this.effectQueue.push({element:t,effect:"slideFast"})}},e.prototype.executeEffectQueue=function(t){var e=this;this.effectQueue.reverse();var o=function(){var n=e.effectQueue.pop();n?e.applyEffect(n.element,n.effect,o):t&&t()};o()},e.prototype.evaluateStringForEntry=function(e,o){var n=e,i=this;return t(e.match(/(\{.*?\})/g)).each(function(){var t=this.toString();n=n.replace(t,i.getValueForToken(t,o))}),n},e.prototype.isRelevant=function(t,e){var o=this.getTokenMap(t);return!this.options.filter||(!this.options.filterLimit||this.options.filterLimit!==e.length)&&this.options.filter(t,o)},e.prototype.getFormattedDate=function(t){return this.options.dateFormatFunction?this.options.dateFormatFunction(t):"undefined"!=typeof moment?(t=(t=moment(new Date(t))).locale?t.locale(this.options.dateLocale):t.lang(this.options.dateLocale)).format(this.options.dateFormat):t},e.prototype.getTokenMap=function(o){if(!this.feedTokens){var n=JSON.parse(JSON.stringify(this.feed));delete n.entries,this.feedTokens=n}return t.extend({feed:this.feedTokens,url:o.link,author:o.author,date:this.getFormattedDate(o.publishedDate),title:o.title,body:o.content,shortBody:o.contentSnippet,bodyPlain:function(t){t=t.content.replace(/<script[\\r\\\s\S]*<\/script>/gim,"").replace(/<\/?[^>]+>/gi,"");for(var o=0;o<e.htmlTags.length;o++)t=t.replace(RegExp("<"+e.htmlTags[o],"gi"),"");return t}(o),shortBodyPlain:o.contentSnippet.replace(/<\/?[^>]+>/gi,""),index:t.inArray(o,this.entries),totalEntries:this.entries.length,teaserImage:function(t){try{return t.content.match(/(<img.*?>)/gi)[0]}catch(t){return""}}(o),teaserImageUrl:function(t){try{return t.content.match(/(<img.*?>)/gi)[0].match(/src="(.*?)"/)[1]}catch(t){return""}}(o)},this.options.tokens)},e.prototype.getValueForToken=function(t,e){var o,n=this.getTokenMap(e);if(void 0!==(o=n[o=t.replace(/[\{\}]/g,"")]))return"function"==typeof o?o(e,n):o;throw Error("Unknown token: "+t+", url:"+this.url)},t.fn.rss=function(t,o,n){return new e(this,t,o,n).render(),this}}(jQuery);